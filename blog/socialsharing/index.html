<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content="#494f5c"><meta name=msapplication-TileColor content="#494f5c"><meta itemprop=name content="Implementing social share buttons"><meta itemprop=description content="Background I was creating social share buttons for Facebook, Twitter, and Whatsapp some time ago. However, these social share buttons weren&rsquo;t only for directly sharing a page&rsquo;s link, but they should also render a custom dynamic title, description, and image based on what the user has entered into the website beforehand. I started reading the documentation of Facebook, Twitter and Whatsapp.
During the implementation phase, I have experienced some details, bits, and quirks of different sharing methods that I would like to share."><meta itemprop=datePublished content="2020-05-09T00:00:00+00:00"><meta itemprop=dateModified content="2020-06-08T13:27:59+03:00"><meta itemprop=wordCount content="1055"><meta itemprop=keywords content><meta property="og:title" content="Implementing social share buttons"><meta property="og:description" content="Background I was creating social share buttons for Facebook, Twitter, and Whatsapp some time ago. However, these social share buttons weren&rsquo;t only for directly sharing a page&rsquo;s link, but they should also render a custom dynamic title, description, and image based on what the user has entered into the website beforehand. I started reading the documentation of Facebook, Twitter and Whatsapp.
During the implementation phase, I have experienced some details, bits, and quirks of different sharing methods that I would like to share."><meta property="og:type" content="article"><meta property="og:url" content="https://ozyinc.com/blog/socialsharing/"><meta property="article:published_time" content="2020-05-09T00:00:00+00:00"><meta property="article:modified_time" content="2020-06-08T13:27:59+03:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Implementing social share buttons"><meta name=twitter:description content="Background I was creating social share buttons for Facebook, Twitter, and Whatsapp some time ago. However, these social share buttons weren&rsquo;t only for directly sharing a page&rsquo;s link, but they should also render a custom dynamic title, description, and image based on what the user has entered into the website beforehand. I started reading the documentation of Facebook, Twitter and Whatsapp.
During the implementation phase, I have experienced some details, bits, and quirks of different sharing methods that I would like to share."><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><title>Implementing social share buttons</title><link rel=stylesheet href=https://ozyinc.com/css/style.min.657bcb7af31123e4156b1a3d2ff60a636717e54ead74f882136b5114cf72b55e.css integrity="sha256-ZXvLevMRI+QVaxo9L/YKY2cX5U6tdPiCE2tRFM9ytV4=" crossorigin=anonymous><link rel=stylesheet href=https://ozyinc.com/css/fa-custom.min.f97eb73d0e8e14deae2b63448b4a5136adebdd755e04fa370cbfbd2cca32b6ff.css integrity="sha256-+X63PQ6OFN6uK2NEi0pRNq3r3XVeBPo3DL+9LMoytv8=" crossorigin=anonymous></head><body id=page><header id=site-header class="animated slideInUp faster"><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=https://ozyinc.com>Ozan İncesulu</a></div><nav class="site-nav hide-in-mobile"><a href=https://ozyinc.com/blog/>Some thoughts</a>
<a href=https://ozyinc.com/cv/>My CV</a>
<a href=https://ozyinc.com/about/>About Me</a></nav></div><div class="hdr-right hdr-icons"><span class="hdr-social hide-in-mobile"><a href=https://www.linkedin.com/in/ozan-incesulu/ target=_blank rel="noopener me" title=Linkedin><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a><a href=https://www.instagram.com/ozyinc/ target=_blank rel="noopener me" title=Instagram><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37z"/><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"/></svg></a><a href=https://github.com/ozyinc/ target=_blank rel="noopener me" title=Github><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></span><button id=menu-btn class=hdr-btn title=Menu><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=https://ozyinc.com/blog/>Some thoughts</a></li><li><a href=https://ozyinc.com/cv/>My CV</a></li><li><a href=https://ozyinc.com/about/>About Me</a></li></ul></div><main class="site-main section-inner animated fadeIn faster"><article class=thin><header class=post-header><div class=post-meta><span>9 May 2020</span></div><h1>Implementing social share buttons</h1></header><div class=content><h3 id=background>Background<a href=#background class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>I was creating social share buttons for Facebook, Twitter, and Whatsapp some time ago. However, these social share buttons weren&rsquo;t only for directly sharing a page&rsquo;s link, but they should also render a custom dynamic title, description, and image based on what the user has entered into the website beforehand. I started reading the documentation of <a href=https://developers.facebook.com/docs/sharing/web>Facebook</a>, <a href=https://developer.twitter.com/en/docs/twitter-for-websites/tweet-button/overview>Twitter</a> and <a href=https://faq.whatsapp.com/en/android/26000030/>Whatsapp</a>.</p><p>During the implementation phase, I have experienced some details, bits, and quirks of different sharing methods that I would like to share.</p><h3 id=facebook>Facebook<a href=#facebook class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>Facebook link sharing is relatively straightforward, and works as documented in their documentation. The basic method is to call their JS API with the URL that you want to be shared. The title, image, and description of the share link are determined by the page&rsquo;s <a href=https://ogp.me/>OpenGraph</a> meta tags, that should exist on the header (the details on how to implement each is available on the API website).</p><p>The fields of interest to me on OpenGraph were:</p><div class=highlight><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>meta</span> <span class=na>property</span><span class=o>=</span><span class=s>&#34;og:title&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;Page Title&#34;</span> <span class=p>/&gt;</span>
<span class=p>&lt;</span><span class=nt>meta</span> <span class=na>property</span><span class=o>=</span><span class=s>&#34;og:description&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;Page description&#34;</span> <span class=p>/&gt;</span>
<span class=p>&lt;</span><span class=nt>meta</span> <span class=na>property</span><span class=o>=</span><span class=s>&#34;og:image&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;Page Image URL&#34;</span> <span class=p>/&gt;</span>
</code></pre></div><p>To provide custom title and description, you have to build a mechanism that can generate those for you, possibly through URL or query parameters. The one point that stands out is that Facebook crawler doesn&rsquo;t execute Javascript, thus populating the <code>meta</code> tags through Javascript code doesn&rsquo;t work. They have provided a debugger for validating to test different URLs <a href=https://developers.facebook.com/tools/debug/>here</a>. Using this tool I was able to see how Facebook would load the share URLs.</p><p>There are some limits that Facebook imposes on content, such as title and description length limit and image size limit. However Facebook seems to be very permissive, it allows large images (1280x768), and it basically crops long titles and descriptions.</p><h3 id=twitter>Twitter<a href=#twitter class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>Twitter provides tweeting via opening a link to a URL. On the URL you can set the tweet text, links, and hashtags that you would like the users to share.</p><p>Thus the HTML on the link looks something like this:</p><div class=highlight><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://twitter.com/intent/tweet?text=URL%20Encoded%20Text&amp;url=https%3A%2F%2Fwww.ozyinc.com&amp;hashtags=hashtag1%2Chashtag2&#34;</span> <span class=na>target</span><span class=o>=</span><span class=s>&#34;_blank&#34;</span><span class=p>&gt;</span>Tweet<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</code></pre></div><p>You have to be careful to explicitly avoid trying to set URLs or hashtags on the tweet text, since they automatically remove links and hashtags from the raw text you provide through the API. The hashtags need to be comma separated and all URL parameters need to be URL encoded for the link to function correctly.</p><p>Twitter has a different customization mechanism than Facebook, cards. There are different types of cards that one can have on a web page and the details are available on the <a href=https://developer.twitter.com/en/docs/tweets/optimize-with-cards/guides/getting-started>twitter cards documentation</a>.</p><p>However, for my case I needed to set the title, image and description of the page, thus I chose to use the <code>summary_large_image</code> card, which one would implement like:</p><div class=highlight><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;charset&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;twitter:card&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;summary_large_image&#34;</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;twitter:title&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;Page title&#34;</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;twitter:description&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;Page description&#34;</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;twitter:image&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;Page Image URL&#34;</span><span class=p>&gt;</span>
</code></pre></div><p>in the <code>head</code> tag. Don&rsquo;t forget to add the <code>charset</code> header or the card might not render correctly since the encoding would not be set.</p><p>To verify your card is working properly you may use the <a href=https://cards-dev.twitter.com/validator>Card Validator</a> by Twitter.</p><p>One final problem that I had with Twitter was that when I used the card validator, I got an error that didn&rsquo;t provide any context on what the problem was. When I searched the problem on Google, it has shown that Twitterbot would fail to parse some pages that are larger than a usual size and/or has an invalid or custom HTML markup.</p><p>As a workaround, I have replaced the backend code to render a blank page with only necessary <code>meta</code> tags for Twitter when the <code>User-Agent</code> is <code>Twitterbot</code> (which is the UserAgent Twitter uses during crawling of web content). With this fix, the cards were finally displayed and everything worked well.</p><h3 id=whatsapp>Whatsapp<a href=#whatsapp class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>When I looked at the documentation of Whatsapp, the only official source of information I had was a <a href=https://faq.whatsapp.com/en/android/26000030/>FAQ link</a> describing how to create links that would open Whatsapp Share. Sneak peek, the mechanism is similar to Twitter and looks something like this:</p><div class=highlight><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://wa.me/?text=urlencodedmsg&#34;</span> <span class=na>target</span><span class=o>=</span><span class=s>&#34;_blank&#34;</span><span class=p>&gt;</span>Send through Whatsapp<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</code></pre></div><p>One should note that that URL only works if the user has a Whatsapp Client installed (like Desktop or Mobile App) and it doesn&rsquo;t work through Whatsapp Web.</p><p>Now, there is no way to directly tell Whatsapp what title and description should be, but if you use Whatsapp you know that the links provided in messages render their title, description and image as a thumbnail on top of the sent message. Apparently, Whatsapp also uses the OpenGraph API to determine the display content to be shown on the message.</p><p>When I first implemented the logic for the URL the same as Facebook, the image didn&rsquo;t render, even though the title and description were correct and there were no errors on Facebook Share Debugger. Upon searching for problems, I have found <a href=https://stackoverflow.com/a/43154489>this Stackoverflow answer</a>, from which I learned that the best way to get images rendered is to have them less than 300Kb of size and make them square.</p><p>After that implementation, it still wasn&rsquo;t visible. Checking other answers, I have also learned that having HTML body elements (or something that the Whatsapp Crawler might not be expecting) before the <code>meta</code> tags, having relative URLs and cached image URLs can be others reasons for why Whatsapp images don&rsquo;t render.</p><p>After making sure that all of the problems given in the answer was verified, the image still wasn&rsquo;t visible and then on a Stackoverflow comment, I suddenly saw my solution. Remember when I mentioned passing query parameters for custom images? Apparently Whatsapp doesn&rsquo;t add query parameters of the URLs so the image was not set when Whatsapp is trying to crawl the website.</p><p>With a huge relief I have rewired the mechanism of dynamic image generation to work with URL parameters instead of query parameters and everything was working.</p><h3 id=conclusion>Conclusion<a href=#conclusion class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>With some debugging effort on fixing weird bugs that exist on both social media crawlers and the shared page, I was able to implement sharing buttons for Facebook, Twitter and Whatsapp. I tried to document the officially documented steps that I took, the problems that I have encountered, and the solutions to those that I have found in this article.</p><p>I hope you enjoyed reading this article and maybe it is helpful to someone that is trying to build sharing buttons.</p><p>Have a nice day!</p></div><hr class=post-end><footer class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>1055 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>09-05-2020</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"/><line x1="1.05" y1="12" x2="7" y2="12"/><line x1="17.01" y1="12" x2="22.96" y2="12"/></svg><a href=https://github.com/ozyinc/website/commit/b985d7098398d58d86768895a0ca6d7b709cdfea target=_blank rel=noopener>b985d70</a> @ 08-06-2020</p></footer></article><div class="post-nav thin"><a class=next-post href=https://ozyinc.com/blog/mutationtesting/><span class=post-nav-label><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>&nbsp;Newer</span><br><span>Mutation Testing with an example</span></a>
<a class=prev-post href=https://ozyinc.com/blog/thispage/><span class=post-nav-label>Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span><br><span>Creating my website in Github Pages using Hugo</span></a></div><div id=comments class=thin></div></main><footer id=site-footer class="section-inner thin animated fadeIn faster"><p>&copy; 2020 <a href=https://ozyinc.com>Ozan İncesulu</a> &#183; <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a> | Some extra icons from <a href=http://fortawesome.github.com/Font-Awesome/ target=_blank>Font Awesome</a></p><p>Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> &#183; Theme <a href=https://github.com/Track3/hermit target=_blank rel=noopener>Hermit</a> &#183; <a href=https://ozyinc.com/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></p></footer><script src=https://ozyinc.com/js/bundle.min.4a9a0ac3d2217822c7865b4161e6c2a71de1d70492264337755427898dd718f6.js integrity="sha256-SpoKw9IheCLHhltBYebCpx3h1wSSJkM3dVQniY3XGPY=" crossorigin=anonymous></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-164775157-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ozyinc.com/js/custom.min.4822070d710ed296a68af6f9dd4f8ee53e2b97337c142c31c035351383d6e09b.js integrity="sha256-SCIHDXEO0pamivb53U+O5T4rlzN8FCwxwDU1E4PW4Js="></script></body></html>